# Coverage Frontend

## 2/1/2023, Wed

- Integrate a real .dat file directly in the unittests (read a .dat file and use its lines in the parse_data test)
- TODO: write a Vue component, that has a hardcoded CoverageEntry[] and string (representing the Verilog file) and just renders each line of the Verilog directly to HTML and annotates its coverage count (just with a number to the left of the Verilog line)

## 1/25/2023, Wed

- Sungwoong's interests from the retreat: GPU RTL design project, Chipyard infra + whole integration story
- Taking: 151 (fpga), 152, 61b

### Vighnesh's TODOs

- TODO: give you a more complex Verilator .dat file we can look at

### TODOs

- https://github.com/vighneshiyer/hw-coverage-viewer
    - Pull this and try to get the local HTTP dev server working + the tests for the coverage parser
    - All sources in `hw-coverage-viewer/src/cov`
    - Run tests with `npm run test:unit`
- Get familiar with the tools
    - vue.js (https://vuejs.org/tutorial/)
    - typescript (https://www.typescriptlang.org/docs/handbook/intro.html) (https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes-oop.html)
- Add assertions to `parse_line` unit test
- Test the `parse_data` function
- Add type annotations to `parser.ts`

### Initial Target

- Parse Verilator .dat files and display coverage info
    - Start with the ALU simulation .dat file
- Develop a simple Vue component that can take raw coverage data in the coverage struct format (`CoverageEntry`) defined in `parser.ts` and the source code of the Verilog file, and display the source code annotated with line numbers and coverage counts
    - Inputs: parsed coverage.dat file, a string representation of a Verilog file
    - Display: a HTML view of the Verilog source with coverage counts annotated on the left hand side

## 11/17/2022

The new goals should be just oriented towards the coverage visualization webapp and not anything concerning FIRRTL passes for coverage instrumentation or designing new digital circuits (e.g. priority queue).

So let’s just focus on the webapp itself and its functionality and then we can fill in the rest of the FIRRTL integration later (Vighnesh can take care of this part).

- Grace: go through the vue tutorial (https://vuejs.org/tutorial/#step-1) and port your code so that it works with vue as the frontend library
    - Syntax highlighting of the Verilog source file
        - prism.js / highlight.js
    - Parse coverage files that contain several modules (potentially several files)
        - File picker so we can look at the different files one at a time
    - Take a look at the lcov or VCS (urg) report (TODO Vighnesh: get you an example of a HTML coverage report generated by VCS, and take a look at what features we’d like to add from it to our coverage viewer)
- Go through the typescript tutorial: https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes.html
- https://github.com/vighneshiyer/hw-coverage-viewer
    - `npm run dev` (spawns a dev server)
    - `npm run test:unit` (runs unittests with vitest)

## 11/10/2022

- Grace: script to parse a coverage.dat file directly and visualize the results in an web app
    - This works, we can parse the file in Javascript and see the results! Nice
    - Next step, given a folder of sources (e.g where the alu.v file is), find the source that corresponds to a coverage point
        - Display the file contents (of alu.v)
        - To the left of alu.v on every line, just add the coverage count to it
    - I’ll set up a Vue scaffold - send you a tutorial

## 11/3/2022

Grace:

- Able to produce a coverage.dat file from Verilator
- Hacking on the verilator coverage.dat parsing
- Next step: port this function to typescript and create a very basic webpage where someone can provide a coverage.dat file and we just dump the function output to the HTML page (as JSON structure)
- TODO Vighnesh: set up scaffolding for a typical vue.js project that we can use for testing and an actual frontend

## 10/27/2022

Grace:

- Continue the FIFO testbench
- Look into the verilator_coverage program to generate a readable report
    - https://ltp.sourceforge.net/coverage/lcov.php (visualize the coverage as an HTML report)
    - `verilator_coverage coverage.dat --write-info asdf.info`
    - `genhtml asdf.info`
    - `firefox index.html`
- https://github.com/ucb-bar/chiseltest/blob/main/src/main/scala/chiseltest/simulator/VerilatorCoverage.scala
    - Understanding of the code
        - CollectCoverageAnnotation => get annos
        - LoadCoverage
            - ParseCoverageData =>
                - read from file
                - parseLine => str stuff & filter out non-user coverage
            - CreateMap with data and annos => map name + “.” + covers the number of entries?
                - contains a map of points and a map of modules
                - process entry by entry with ProcessInstanceCoverage
        - FindCoverPointsPass =>
            - Execute =>
            - OnModule =>
            - onStmt => I don’t fully understand what the code is doing?
    - Can you port a bit of this into typescript?
        - Typescript Notes (https://www.typescriptlang.org/docs/handbook/intro.html)
    - TODO Vighnesh: find a small typescript dev template (w/ test runner, npm config, …)
    - TBD: what front-end framework to use? React, Vue, Svelte, Angular, …
